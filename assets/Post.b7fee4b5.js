import{P as g}from"./PostCard.45c9ad06.js";import{L as f,E as u}from"./EmptyCard.364d6113.js";import{p as n}from"./posts.2f8032c2.js";import{_ as y,d as C,p as L,g as P,q as _,x as v,r as d,o as l,m}from"./index.1480d001.js";import"./Avatar.a472d7d4.js";const w={components:{PostCard:g,LoadingCard:f,EmptyCard:u},setup(){const p=C(),s=L();let r=P({}),t=_(!0);const c=async()=>{try{t.value=!0;const e=await n.getPost(p.params.postId);Object.assign(r,e)}catch{s.error("\u67E5\u7121\u8CBC\u6587")}finally{t.value=!1}},k=async(e,a)=>{let o={};r.isLoading=!0;try{a==="like"?o=await n.likePost(e):o=await n.unlikePost(e),r.likes=o.data.likes}catch{s.error(a==="like"?"\u53D6\u6D88\u6309\u8B9A\u5931\u6557":"\u6309\u8B9A\u5931\u6557")}finally{r.isLoading=!1}},i=async(e,a)=>{try{const o=await n.addComment({comment:e,id:a});r.comments.push(o)}catch{s.error("\u7559\u8A00\u5931\u6557")}};return v(()=>{c()}),{post:r,isLoading:t,toggleLike:k,addComment:i}}};function x(p,s,r,t,c,k){const i=d("LoadingCard"),e=d("EmptyCard"),a=d("PostCard");return t.isLoading?(l(),m(i,{key:0})):t.post._id?(l(),m(a,{key:2,post:t.post,onUnlikePost:s[0]||(s[0]=o=>t.toggleLike(o,"unlike")),onLikePost:s[1]||(s[1]=o=>t.toggleLike(o,"like")),onAddComment:s[2]||(s[2]=o=>t.addComment(o,t.post.id))},null,8,["post"])):(l(),m(e,{key:1}))}var I=y(w,[["render",x]]);export{I as default};
