import{P as I}from"./PostCard.f1a93179.js";import{L as B,E}from"./EmptyCard.2cbc392b.js";import{p}from"./posts.4104fa84.js";import{_ as K,l as U,e as V,d as M,m as w,g as D,p as F,f as L,q as N,s as O,r as _,o as r,c,b as d,v as C,x as T,F as g,h as P,y as W,z as q,k as S,t as z,a as A,A as R,B as j}from"./index.b287f4de.js";const G={components:{PostCard:I,LoadingCard:B,EmptyCard:E},setup(){const n=U(),s=V(),i=M();let e=w("desc"),m=w(null),a=D([]),u=w(!1);const f=F([{text:"\u6700\u65B0\u8CBC\u6587",value:"desc"},{text:"\u6700\u820A\u8CBC\u6587",value:"asc"}]),v=L(()=>s.getters["users/user"]),t=L(()=>v.value._id===i.params.userId),o=async()=>{try{a.splice(0),u.value=!0;let l=null;i.name==="posts-wall"?l=await p.getPosts({timeSort:e.value,content:m.value}):l=await p.getUserPosts({userId:i.params.userId,timeSort:e.value,content:m.value}),a.push(...l),u.value=!1}catch{n.error("\u8F09\u5165\u8CBC\u6587\u5931\u6557\uFF0C\u8ACB\u91CD\u65B0\u6574\u7406")}},b=async(l,x)=>{let y={};const k=a.findIndex(h=>h._id===l);a[k].isLoading=!0;try{x==="like"?y=await p.likePost(l):y=await p.unlikePost(l),a[k].likes=y.data.likes}catch{n.error(x==="like"?"\u53D6\u6D88\u6309\u8B9A\u5931\u6557":"\u6309\u8B9A\u5931\u6557")}finally{a[k].isLoading=!1}};return N(()=>{o()}),O(i,()=>{i.name==="personal-wall"&&o()}),{posts:a,isLoading:u,sortOption:f,timeSort:e,searchKeyword:m,getPosts:o,toggleLike:b,isUser:t}}},H=n=>(R("data-v-2fcf8aa9"),n=n(),j(),n),J={class:"mb-4 flex"},Q=["value"],X={class:"w-full flex shadow-md rounded-lg overflow-hidden"},Y=H(()=>d("i",{class:"fa-solid fa-magnifying-glass"},null,-1)),Z=[Y];function $(n,s,i,e,m,a){const u=_("LoadingCard"),f=_("EmptyCard"),v=_("PostCard");return r(),c(g,null,[d("div",J,[C(d("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>e.timeSort=t),name:"",id:"",class:"py-3 pl-4 pr-1 mr-3 outline-none shadow-md rounded-lg bg-white",onChange:s[1]||(s[1]=(...t)=>e.getPosts&&e.getPosts(...t))},[(r(!0),c(g,null,P(e.sortOption,t=>(r(),c("option",{key:t.value,value:t.value},z(t.text),9,Q))),128))],544),[[T,e.timeSort]]),d("div",X,[C(d("input",{class:"!bg-white w-full h-full py-3 px-4 outline-none flex-1 !rounded-r-none",type:"text","onUpdate:modelValue":s[2]||(s[2]=t=>e.searchKeyword=t),placeholder:"\u641C\u5C0B\u8CBC\u6587",onKeyup:s[3]||(s[3]=q((...t)=>e.getPosts&&e.getPosts(...t),["enter"]))},null,544),[[W,e.searchKeyword]]),d("button",{class:"block text-white w-[46px] btn-secondary font-[20px] outline-none rounded-l-none",onClick:s[4]||(s[4]=(...t)=>e.getPosts&&e.getPosts(...t))},Z)])]),e.isLoading?(r(),c(g,{key:0},P(3,(t,o)=>A(u,{key:o,class:"mb-4 last:mb-0"})),64)):e.posts.length===0?(r(),S(f,{key:1})):(r(!0),c(g,{key:2},P(e.posts,t=>(r(),S(v,{key:t.id,post:t,class:"mb-4 last:mb-0",onUnlikePost:s[5]||(s[5]=o=>e.toggleLike(o,"unlike")),onLikePost:s[6]||(s[6]=o=>e.toggleLike(o,"like"))},null,8,["post"]))),128))],64)}var ae=K(G,[["render",$],["__scopeId","data-v-2fcf8aa9"]]);export{ae as default};
