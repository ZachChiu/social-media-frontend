import{I as b,d as L}from"./EmptyCard.9f4bcfe7.js";import{_ as w,u as I,f as i,r as p,o as s,c as a,a as h,F as v,h as Y,t as A,e as M,d as T,q as D,b as c,i as x,n as O,y as j,A as B,m as V}from"./index.531b88c4.js";import{A as z}from"./Avatar.57711b14.js";const H={components:{Info:b},props:{comment:{type:Object,default(){return{}}}},setup(n){const o=I(),t=i(()=>L(n.comment.createdAt).format("YYYY/MM/DD H:mm")),e=()=>{o.push({name:"personal-wall",params:{userId:n.comment.user._id}})},d=i(()=>n.comment.comment.split(`
`));return{subText:t,onClickPersonal:e,commmentList:d}}},N={class:"comment-card bg-gray-light rounded-md p-4"};function q(n,o,t,e,d,C){const l=p("Info");return s(),a("div",N,[h(l,{username:t.comment.user.name,avatar:t.comment.user.photo,"sub-text":e.subText,onOnClickPersonal:e.onClickPersonal},null,8,["username","avatar","sub-text","onOnClickPersonal"]),(s(!0),a(v,null,Y(e.commmentList,(k,m)=>(s(),a("p",{key:m,class:"ml-[56px] mt-1"},A(k),1))),128))])}var F=w(H,[["render",q]]);const R={components:{Comment:F,Avatar:z,Info:b},props:{post:{type:Object,default(){return{}}}},setup(n,{emit:o}){const t=M(),e=I(),d=T(),C=_=>_.replace(`
`,"<br>"),l=D(""),k=i(()=>d.name==="post"),m=i(()=>t.getters["users/user"]),u=i(()=>n.post.likes.includes(m.value._id)),f=i(()=>{var P,y;let _=(P=n.post)==null?void 0:P.likes.length,g=(y=n.post)==null?void 0:y.likes.length;return u.value&&(_=`\u4F60${g-1>0?`\u548C\u5176\u4ED6 ${g-1} \u4EBA`:""}`),_});return{dayjs:L,onClickLike:()=>{n.post.isLoading||(u.value?o("unlike-post",n.post._id):o("like-post",n.post._id))},onClick2Post:()=>{e.push({name:"post",params:{postId:n.post._id}})},onClickComment:()=>{o("add-comment",l.value),l.value=""},user:m,processContent:C,onClickPersonal:()=>{e.push({name:"personal-wall",params:{userId:n.post.user._id}})},getLikesText:f,hasLikePost:u,inPostPage:k,userPhoto:i(()=>t.getters["users/userPhoto"]),comment:l}}},S={class:"post w-full p-5 card"},E={class:"post-info flex items-center mb-4"},U=["innerHTML"],G=["src"],J={key:0,class:"fa-solid fa-spinner text-primary animate-spin-slow text-[20px]"},K={key:2,class:"ml-2 group-hover:text-primary"},Q={key:3,class:"ml-2 group-hover:text-primary"},W={class:"flex items-center mt-4"},X={class:"w-full h-full flex rounded-shadow overflow-hidden"};function Z(n,o,t,e,d,C){var u,f;const l=p("Info"),k=p("Avatar"),m=p("Comment");return s(),a("div",S,[c("div",E,[h(l,{username:t.post.user.name,avatar:t.post.user.photo,"sub-text":e.dayjs(t.post.createdAt).format("YYYY/MM/DD mm:ss"),size:"45",onOnClickPersonal:e.onClickPersonal},null,8,["username","avatar","sub-text","onOnClickPersonal"])]),c("div",{class:"content",innerHTML:e.processContent(t.post.content)},null,8,U),t.post.image?(s(),a("img",{key:0,class:"w-full mt-4 rounded-shadow",src:t.post.image,alt:""},null,8,G)):x("",!0),c("div",{class:"group likes mt-4 cursor-pointer flex items-center w-fit",onClick:o[0]||(o[0]=(...r)=>e.onClickLike&&e.onClickLike(...r))},[t.post.isLoading?(s(),a("i",J)):(s(),a("i",{key:1,class:O(["fa-regular fa-thumbs-up transition group-hover:text-primary text-[20px]",{"text-primary":e.hasLikePost}])},null,2)),(u=t.post.likes)!=null&&u.length?(s(),a("span",K,A(e.getLikesText),1)):(s(),a("span",Q,"\u6210\u70BA\u7B2C\u4E00\u500B\u6309\u8B9A\u7684\u670B\u53CB"))]),c("div",W,[h(k,{avatar:e.userPhoto,size:"35"},null,8,["avatar"]),c("div",X,[j(c("textarea",{name:"content",id:"content",rows:"1",placeholder:"\u8AAA\u9EDE\u4EC0\u9EBC...",required:"",autofocus:"",autocomplete:"off",class:"py-1 px-2 rounded-r-none","onUpdate:modelValue":o[1]||(o[1]=r=>e.comment=r)},null,512),[[B,e.comment]]),c("button",{class:"btn-secondary block text-white w-[100px] font-[20px] outline-none rounded-l-none",onClick:o[2]||(o[2]=(...r)=>e.onClickComment&&e.onClickComment(...r))}," \u7559\u8A00 ")])]),(f=t.post.comments)!=null&&f.length?(s(),a(v,{key:1},[(s(!0),a(v,null,Y(e.inPostPage?t.post.comments:[t.post.comments[0]],r=>(s(),V(m,{key:r._id,comment:r,class:"mt-4"},null,8,["comment"]))),128)),!e.inPostPage&&t.post.comments.length>1?(s(),a("p",{key:0,class:"mt-2 text-primary hover:underline cursor-pointer",onClick:o[3]||(o[3]=(...r)=>e.onClick2Post&&e.onClick2Post(...r))}," \u67E5\u770B\u5168\u90E8 ")):x("",!0)],64)):x("",!0)])}var ae=w(R,[["render",Z]]);export{ae as P};
