import{P as B}from"./PostCard.64f90cfb.js";import{L as E,E as K}from"./EmptyCard.eae8066c.js";import{p as g}from"./posts.31c25c06.js";import{_ as U,p as V,e as A,d as D,q as x,g as M,s as F,f as h,v as N,x as O,r as P,o as i,c as f,b as u,y as b,z as T,F as k,h as C,A as W,B as q,m as L,t as z,a as R,C as j,D as G}from"./index.e77130f5.js";import"./Avatar.cd22d5d3.js";const H={components:{PostCard:B,LoadingCard:E,EmptyCard:K},setup(){const r=V(),s=A(),l=D();let e=x("desc"),v=x(null),a=M([]),d=x(!1);const w=F([{text:"\u6700\u65B0\u8CBC\u6587",value:"desc"},{text:"\u6700\u820A\u8CBC\u6587",value:"asc"}]),_=h(()=>s.getters["users/user"]),t=h(()=>_.value._id===l.params.userId),o=async()=>{try{a.splice(0),d.value=!0;let n=null;l.name==="posts-wall"?n=await g.getPosts({timeSort:e.value,content:v.value}):n=await g.getUserPosts({userId:l.params.userId,timeSort:e.value,content:v.value}),a.push(...n),d.value=!1}catch{r.error("\u8F09\u5165\u8CBC\u6587\u5931\u6557\uFF0C\u8ACB\u91CD\u65B0\u6574\u7406")}},S=async(n,m)=>{let c={};const p=a.findIndex(y=>y._id===n);a[p].isLoading=!0;try{m==="like"?c=await g.likePost(n):c=await g.unlikePost(n),a[p].likes=c.data.likes}catch{r.error(m==="like"?"\u53D6\u6D88\u6309\u8B9A\u5931\u6557":"\u6309\u8B9A\u5931\u6557")}finally{a[p].isLoading=!1}},I=async(n,m)=>{try{const c=a.findIndex(y=>y._id===m),p=await g.addComment({comment:n,id:m});a[c].comments.unshift(p)}catch{r.error("\u7559\u8A00\u5931\u6557")}};return N(l,()=>{l.name==="personal-wall"&&(d.value=!0,o())}),O(()=>{d.value||o()}),{route:l,posts:a,isLoading:d,sortOption:w,timeSort:e,searchKeyword:v,getPosts:o,toggleLike:S,isUser:t,addComment:I}}},J=r=>(j("data-v-6fc3241b"),r=r(),G(),r),Q={class:"mb-4 flex"},X=["value"],Y={class:"w-full flex shadow-md rounded-lg overflow-hidden"},Z=J(()=>u("i",{class:"fa-solid fa-magnifying-glass"},null,-1)),$=[Z];function ee(r,s,l,e,v,a){const d=P("LoadingCard"),w=P("EmptyCard"),_=P("PostCard");return i(),f(k,null,[u("div",Q,[b(u("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>e.timeSort=t),name:"",id:"",class:"py-3 pl-4 pr-1 mr-3 outline-none shadow-md rounded-lg bg-white",onChange:s[1]||(s[1]=(...t)=>e.getPosts&&e.getPosts(...t))},[(i(!0),f(k,null,C(e.sortOption,t=>(i(),f("option",{key:t.value,value:t.value},z(t.text),9,X))),128))],544),[[T,e.timeSort]]),u("div",Y,[b(u("input",{class:"!bg-white w-full h-full py-3 px-4 outline-none flex-1 !rounded-r-none",type:"text","onUpdate:modelValue":s[2]||(s[2]=t=>e.searchKeyword=t),placeholder:"\u641C\u5C0B\u8CBC\u6587",onKeyup:s[3]||(s[3]=q((...t)=>e.getPosts&&e.getPosts(...t),["enter"]))},null,544),[[W,e.searchKeyword]]),u("button",{class:"block text-white w-[46px] btn-secondary font-[20px] outline-none rounded-l-none",onClick:s[4]||(s[4]=(...t)=>e.getPosts&&e.getPosts(...t))},$)])]),e.isLoading?(i(),f(k,{key:0},C(3,(t,o)=>R(d,{key:o,class:"mb-4 last:mb-0"})),64)):e.posts.length===0?(i(),L(w,{key:1})):(i(!0),f(k,{key:2},C(e.posts,t=>(i(),L(_,{key:t.id,post:t,class:"mb-4 last:mb-0",onUnlikePost:s[5]||(s[5]=o=>e.toggleLike(o,"unlike")),onLikePost:s[6]||(s[6]=o=>e.toggleLike(o,"like")),onAddComment:o=>e.addComment(o,t.id)},null,8,["post","onAddComment"]))),128))],64)}var re=U(H,[["render",ee],["__scopeId","data-v-6fc3241b"]]);export{re as default};
