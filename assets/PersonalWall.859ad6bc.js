import F from"./PostsWall.bccc9e5b.js";import{L as C}from"./EmptyCard.8e48a0a4.js";import{A as I}from"./Avatar.1573c68c.js";import{_ as D,p as L,d as P,e as B,q as y,g as W,f as v,v as j,x as A,r as p,o,c as l,m as N,a as b,b as g,t as w,n as U,j as V,i as x,F as S,H as h}from"./index.e9d10c37.js";import"./PostCard.5ce56b98.js";import"./posts.b2e1eba5.js";const z={components:{PostWall:F,LoadingCard:C,Avatar:I},setup(){const _=L(),a=P(),f=B(),e=y(!1),n=y(!1);let d=W({});const i=v(()=>f.getters["users/user"]),c=v(()=>i.value._id===a.params.userId),t=v(()=>{var s,m;return c.value?!1:(m=(s=i.value)==null?void 0:s.following)==null?void 0:m.some(k=>k.user._id===a.params.userId)}),r=async()=>{const s=await h.getUserById(a.params.userId);Object.assign(d,s)},u=async()=>{if(!n.value)try{n.value=!0,t.value?await h.deleteFollow(a.params.userId):await h.postFollow(a.params.userId),await r(),await f.dispatch("users/getUser"),_.success(t.value?"\u5DF2\u53D6\u6D88\u8FFD\u8E64":"\u5DF2\u8FFD\u8E64")}catch{_.error(t.value?"\u53D6\u6D88\u8FFD\u8E64\u5931\u6557":"\u8FFD\u8E64\u5931\u6557")}finally{n.value=!1}};return j(a,async()=>{a.name==="personal-wall"&&(e.value=!0,await r(),e.value=!1)}),A(async()=>{c.value?Object.assign(d,i.value):(e.value=!0,await r(),e.value=!1)}),{personalData:d,isUser:c,isLoading:e,isFetching:n,hasFollowed:t,toggleFollow:u}}},O={key:1,class:"card flex mb-4 overflow-hidden"},T={class:"p-4 flex items-center justify-between flex-1"},q={class:"flex-1 mr-5"},E={class:"font-bold"},H={key:0,class:"animate-pulse h-2 rounded bg-gray my-2 w-full"},M={key:1},R={key:0,class:"fa-solid fa-spinner animate-spin-slow text-sm"};function G(_,a,f,e,n,d){var r,u,s;const i=p("LoadingCard"),c=p("Avatar"),t=p("PostWall");return o(),l(S,null,[e.isLoading?(o(),N(i,{key:0,class:"mb-4 last:mb-0"})):(o(),l("div",O,[b(c,{class:"!mr-0",avatar:(r=e.personalData)==null?void 0:r.photo,size:"80",rounded:!1},null,8,["avatar"]),g("div",T,[g("div",q,[g("p",E,w(e.personalData.name),1),e.isFetching?(o(),l("div",H)):(o(),l("p",M,w((s=(u=e.personalData)==null?void 0:u.followers)==null?void 0:s.length)+" \u4EBA\u8FFD\u8E64",1))]),e.isUser?x("",!0):(o(),l("button",{key:0,class:U(["text-dark hover:text-white disabled:bg-disabled disabled:text-white font-bold py-1 px-8 block rounded-shadow",[e.hasFollowed?"bg-gray hover:bg-dark":"bg-secondary hover:bg-primary"]]),onClick:a[0]||(a[0]=(...m)=>e.toggleFollow&&e.toggleFollow(...m))},[V(w(e.hasFollowed?"\u53D6\u6D88\u8FFD\u8E64":"\u8FFD\u8E64")+" ",1),e.isFetching?(o(),l("i",R)):x("",!0)],2))])])),b(t)],64)}var $=D(z,[["render",G],["__scopeId","data-v-316680a1"]]);export{$ as default};
